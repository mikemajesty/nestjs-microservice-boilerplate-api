# i18n Service

Internationalization library that enables **multi-language support** for your API. Automatically detects user's preferred language and returns translated messages.

## The Problem

```
❌ Without i18n:
- All messages hardcoded in one language
- Can't serve international users

✅ With i18n:
- Automatic language detection per request
- Organized translation files
```

## How Language Is Selected

The module detects language from these sources (in priority order):

```
┌─────────────────────────────────────────────────────────────────┐
│  1. Query Parameter: ?lang=pt         (highest priority)        │
│  2. Accept-Language Header            (from browser/client)     │
│  3. Fallback: 'en'                    (default)                 │
└─────────────────────────────────────────────────────────────────┘
```

### Query Parameter

```bash
GET /api/users?lang=pt    # Forces Portuguese
GET /api/users?lang=en    # Forces English
```

### Accept-Language Header

```bash
curl -H "Accept-Language: pt-BR" /api/users
```

### Resolution Config

```typescript
// src/libs/i18n/module.ts
resolvers: [
  { use: QueryResolver, options: ['lang'] },  // Check ?lang= first
  AcceptLanguageResolver                       // Then check header
]
```

## Translation Files

```
src/libs/i18n/languages/
├── en/
│   └── info.json    # { "HELLO": "Hello", "WELCOME": "Welcome, {name}!" }
└── pt/
    └── info.json    # { "HELLO": "Olá", "WELCOME": "Bem-vindo, {name}!" }
```

## API Usage

### Basic Translation

```typescript
@Injectable()
export class GreetingService {
  constructor(private readonly i18n: II18nAdapter) {}

  getHello(): string {
    return this.i18n.translate('info.HELLO')
    // "Hello" (en) or "Olá" (pt)
  }
}
```

### With Variables

```typescript
getWelcome(name: string): string {
  return this.i18n.translate('info.WELCOME', {
    args: { name }
  })
  // "Welcome, John!" or "Bem-vindo, John!"
}
```

### With Default Value

```typescript
getMessage(key: string): string {
  return this.i18n.translate(key, {
    defaultValue: 'Message not available'
  })
}
```

## TranslateOptions

| Option | Type | Description |
|--------|------|-------------|
| `args` | `object` | Variables for interpolation `{name}` |
| `defaultValue` | `string` | Fallback if key not found |
| `debug` | `boolean` | Enable debug mode |

## Adding a New Language

1. Create folder: `src/libs/i18n/languages/es/`
2. Add JSON files with same keys as `en/`
3. Test: `curl -H "Accept-Language: es" /api/endpoint`

## Summary

| Feature | Description |
|---------|-------------|
| **Detection** | `?lang=` query param or `Accept-Language` header |
| **Fallback** | Defaults to `'en'` |
| **Interpolation** | `{variable}` syntax in translations |

**i18n Service** - *Multi-language support with automatic detection.*
